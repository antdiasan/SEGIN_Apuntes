# Control de Acceso: Autorización (ACL)

Una vez que el sistema ha autenticado correctamente a un usuario, el siguiente paso es determinar **a qué recursos puede acceder y qué tipo de acciones puede realizar**.  
Este proceso se conoce como **control de acceso**, y constituye una parte esencial de la seguridad activa, ya que permite mantener el orden y la confidencialidad dentro del sistema.

El control de acceso evita que usuarios no autorizados puedan leer, modificar o eliminar información, y garantiza que cada persona actúe únicamente dentro de los límites de su perfil o rol.  
Sin un sistema de control de acceso eficaz, cualquier autenticación sería inútil, ya que todos los usuarios podrían realizar las mismas acciones sin restricciones.

---

## 1. Concepto de control de acceso

El **control de acceso** es el conjunto de mecanismos que regulan qué operaciones puede realizar cada usuario sobre los recursos del sistema: archivos, carpetas, impresoras, servicios de red, bases de datos, aplicaciones, etc.  
Su propósito es **evitar el acceso indebido a información o recursos**, asegurando que los usuarios solo puedan realizar aquellas operaciones que su rol o función les permite.

Estos mecanismos se aplican tanto a nivel **local** (en un ordenador individual) como a nivel **de red** (en servidores o dominios empresariales).  
Por ejemplo, en un servidor de archivos compartido, no todos los empleados deben tener los mismos derechos: el departamento de contabilidad puede necesitar acceso completo a sus documentos, mientras que el resto solo debería tener acceso de lectura.

El control de acceso se apoya en tres elementos básicos:

1. **Identidad del usuario:** se establece durante el proceso de autenticación, es decir, cuando el sistema verifica quién es.  
2. **Reglas o políticas de acceso:** definen las condiciones bajo las cuales se puede acceder a cada recurso (quién, qué y cómo).  
3. **Mecanismo de decisión:** el sistema compara la solicitud del usuario con las reglas configuradas y, en función de ellas, **permite o deniega la acción**.

Estas tres piezas trabajan juntas en tiempo real, garantizando que cada intento de acceso sea evaluado de acuerdo con la política de seguridad establecida.

---

## 2. Tipos de control de acceso

A lo largo del tiempo se han desarrollado diferentes modelos de control de acceso.  
Cada uno de ellos responde a distintas necesidades organizativas o niveles de seguridad, variando en la forma en que se conceden los permisos y quién los gestiona.

### Control de acceso discrecional (DAC)

En el **control de acceso discrecional (Discretionary Access Control)**, el propietario de un recurso (por ejemplo, un archivo o una carpeta) decide quién puede acceder a él y con qué permisos.  
El usuario tiene la libertad de conceder o revocar permisos a otros usuarios o grupos, dentro de los límites del sistema operativo.

Es el modelo más habitual en sistemas operativos como **Windows** o **Linux**, donde el propietario de un archivo puede modificar sus permisos mediante las opciones de seguridad del sistema.

*Ejemplo:*  
Un usuario crea una carpeta llamada “Informes” y concede permiso de lectura a su compañero, pero no de escritura.  
De este modo, el compañero puede consultar los documentos, pero no modificarlos ni eliminarlos.

Este modelo es flexible y fácil de administrar en entornos pequeños, pero también más vulnerable, ya que los usuarios pueden asignar permisos inadecuados o excesivos, generando riesgos de seguridad.

---

### Control de acceso obligatorio (MAC)

El **control de acceso obligatorio (Mandatory Access Control)** aplica políticas de seguridad rígidas definidas por el administrador o por la organización.  
Los usuarios no pueden modificar los permisos asignados ni decidir quién accede a qué recursos.

Este modelo se utiliza en entornos de alta seguridad, como instituciones gubernamentales, militares o redes que manejan información clasificada.  
En estos casos, tanto los usuarios como los recursos se clasifican con diferentes niveles de seguridad (por ejemplo: **Público**, **Confidencial**, **Secreto**, **Alto Secreto**), y el sistema solo permite el acceso cuando el nivel de autorización del usuario **coincide o supera** el nivel del recurso.

La ventaja del MAC es su **gran robustez**, ya que el control recae totalmente en las políticas del sistema.  
Su desventaja es la **rigidez**, lo que lo hace menos práctico en entornos empresariales con necesidades dinámicas.

---

### Control de acceso basado en roles (RBAC)

El **control de acceso basado en roles (Role-Based Access Control)** es uno de los modelos más utilizados en entornos corporativos actuales.  
En lugar de asignar permisos directamente a los usuarios, se asignan a **roles** o **puestos de trabajo** (por ejemplo, “Administrador”, “Profesor”, “Estudiante”, “Invitado”).  
Cada usuario hereda los permisos correspondientes al rol que desempeña en la organización.

Esto permite una gestión mucho más sencilla y escalable.  
Si un nuevo empleado se incorpora, basta con asignarle el rol adecuado para que obtenga automáticamente los permisos necesarios.  
Del mismo modo, si cambia de departamento, basta con cambiarle de grupo o rol, sin necesidad de modificar decenas de permisos individuales.

El modelo RBAC favorece la **coherencia** y el cumplimiento de las políticas de seguridad, reduciendo errores humanos en la asignación de permisos.

---

## 3. Listas de Control de Acceso (ACL)

Las **Listas de Control de Acceso (ACL)** son el método práctico más común para implementar el control de acceso en sistemas informáticos modernos.  
Una ACL es, en esencia, un **conjunto de reglas** asociado a un recurso del sistema (como un archivo, carpeta o impresora) que especifica los **permisos concedidos o denegados** a usuarios o grupos.

Cada entrada de la lista, conocida como **ACE** (*Access Control Entry*), define:
- El **usuario o grupo** al que se aplica la regla.  
- El **tipo de permiso** (lectura, escritura, ejecución, modificación, eliminación, etc.).  
- Si el permiso se **concede** o se **deniega**.

Cuando un usuario intenta acceder a un recurso, el sistema revisa su ACL para decidir si la acción está permitida o no.

---

### Grupos de Usuarios

En la mayoría de los sistemas, los administradores organizan a los usuarios en **grupos** que representan funciones, departamentos o niveles de responsabilidad (por ejemplo, “Ventas”, “Dirección”, “Administradores”, “Alumnos”).  
Asignar permisos a grupos en lugar de a usuarios individuales **simplifica enormemente la administración**, ya que basta con añadir o eliminar un usuario del grupo para modificar automáticamente sus privilegios.

Además, trabajar con grupos mejora la trazabilidad y facilita las auditorías de seguridad, permitiendo saber rápidamente qué conjunto de usuarios tiene acceso a un recurso determinado.

---

### Reglas de Prioridad y Herencia

Las ACL siguen un conjunto de reglas que determinan cómo se combinan los permisos cuando existen conflictos o jerarquías.

#### Predominio de la Denegación
La regla más importante es que la **denegación siempre tiene prioridad sobre la concesión** (*deny-first*).  
Si un usuario pertenece a dos grupos con permisos contradictorios (uno concede acceso y el otro lo deniega), prevalece la **denegación**.  
Este comportamiento garantiza que, ante la duda, el sistema opte por la opción más segura.

#### Herencia de Permisos
En muchos sistemas de archivos, los permisos de una carpeta se **heredan** automáticamente por las subcarpetas y archivos que contiene.  
Esto facilita la configuración inicial, pero puede generar situaciones indeseadas si no se revisa adecuadamente.  
Por ejemplo, una subcarpeta con información confidencial puede heredar permisos de lectura de su carpeta principal, exponiendo datos sensibles.  
Por ello, la herencia puede **desactivarse** cuando se requiere un control más preciso.

#### Permisos Efectivos
Cuando un usuario pertenece a varios grupos con permisos distintos, el sistema combina todas las reglas para calcular los llamados **permisos efectivos**, es decir, los que realmente tiene el usuario en ese recurso.  
Si hay conflicto entre una regla de concesión y otra de denegación, **prevalece la denegación**, asegurando que ninguna contradicción pueda otorgar acceso indebido.

---

### Ejemplos Prácticos

#### En Windows
En las propiedades de cualquier archivo o carpeta, la pestaña **“Seguridad”** muestra una lista de usuarios y grupos con sus permisos asociados.  
Por ejemplo:
- `Antonio` → Lectura y escritura  
- `Usuarios` → Solo lectura  
- `Administradores` → Control total  

El sistema evalúa estas reglas cada vez que alguien intenta acceder al recurso.

#### En Linux
Los sistemas Linux implementan permisos básicos mediante tres categorías: **propietario**, **grupo** y **otros**, con tres tipos de permiso:  
- `r` (read) → lectura  
- `w` (write) → escritura  
- `x` (execute) → ejecución  

Por ejemplo, la notación:
```
-rw-r--r--
```
indica que:
- El propietario puede leer y escribir.  
- El grupo puede leer.  
- Los demás solo pueden leer.

Además, Linux permite **ACL extendidas** para definir permisos más específicos, utilizando los comandos `setfacl` y `getfacl`.  
Esto resulta muy útil en entornos multiusuario donde los permisos tradicionales son insuficientes.

---

## 4. Elevación de Privilegios

Uno de los principales riesgos asociados al control de acceso es la **elevación de privilegios**, también conocida como *escalada de privilegios*.  
Se produce cuando un atacante —ya sea un usuario interno o un software malicioso— consigue ampliar sus permisos más allá de los que originalmente se le habían concedido.

Por ejemplo, un virus que se ejecuta con los permisos de un usuario estándar puede intentar aprovechar una vulnerabilidad del sistema para ejecutar código con permisos de administrador.  
Una vez que lo logra, puede modificar archivos críticos, desactivar el antivirus o tomar el control completo del equipo.

**Recomendación:**  
Los administradores deben evitar iniciar sesión directamente con su cuenta de máximo privilegio para realizar tareas rutinarias.  
Los sistemas operativos modernos (como Windows, Linux o macOS) permiten ejecutar acciones administrativas mediante un sistema de **elevación controlada de privilegios**, que solicita las credenciales de administrador únicamente cuando es necesario.  
Esto reduce el tiempo durante el cual una cuenta con derechos elevados permanece activa, minimizando el riesgo de ataques.

---

## 5. Buenas Prácticas en el Control de Acceso

- Asignar permisos siempre a **grupos**, no a usuarios individuales.  
- Aplicar el **principio de mínimo privilegio** en toda la organización.  
- Revisar periódicamente las ACL y eliminar accesos innecesarios.  
- Documentar los cambios realizados en los permisos.  
- Evitar el uso habitual de la cuenta de administrador.  
- Deshabilitar o eliminar cuentas inactivas.  
- Verificar regularmente los permisos efectivos de los usuarios con acceso a recursos críticos.

El control de acceso es un pilar fundamental de la seguridad activa.  
Un sistema correctamente configurado, con permisos bien definidos y revisados de forma periódica, protege tanto la información como la estabilidad del sistema frente a errores humanos o ataques deliberados.
